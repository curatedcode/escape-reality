---
import {
	CalendarIcon,
	InfinityIcon,
	TerminalIcon,
	UsersIcon,
	ZapIcon,
} from "lucide-react";
import ExperienceCard from "~/components/ExperienceCard.astro";
import ProcessCard from "~/components/ProcessCard.astro";
import TestimonialCard from "~/components/TestimonialCard.astro";
import { buttonVariants } from "~/components/ui/button";
import Layout from "~/layouts/Layout.astro";

const experiences = [
	{
		title: "CLUE_DUNNIT?",
		image: "/assets/images/clue-dunnit-preview.webp",
		difficulty: 3,
		duration: "60 MIN",
		players: "2-8",
		description:
			"Solve a chilling murder case in an abandoned mansion before you become the next victim.",
		color: "glitch-red",
	},
	{
		title: "TOXIC_TAKEDOWN",
		image: "/assets/images/toxic-takedown-preview.webp",
		difficulty: 4,
		duration: "60 MIN",
		players: "3-8",
		description:
			"Join an elite FBI team to infiltrate a criminal organization and recover stolen intelligence.",
		color: "glitch-green",
	},
	{
		title: "HEIST",
		image: "/assets/images/heist-preview.webp",
		difficulty: 4,
		duration: "60 MIN",
		players: "3-10",
		description:
			"Break into a famous brewery and quickly steal their secret recipe before security catches you.",
		color: "glitch-cyan",
	},
] as const;

const processSteps = [
	{
		icon: TerminalIcon,
		code: "SELECT_ROOM",
		title: "Choose Your Portal",
		description:
			"Browse available rooms and select the reality you wish to escape into.",
	},
	{
		icon: CalendarIcon,
		code: "BOOK_TIMESLOT",
		title: "Reserve Your Slot",
		description: "Lock in your preferred date and time.",
	},
	{
		icon: UsersIcon,
		code: "ASSEMBLE_TEAM",
		title: "Gather Your Crew",
		description:
			"Bring 2-10 allies. Some realities require strength in numbers.",
	},
	{
		icon: ZapIcon,
		code: "BREAK_REALITY",
		title: "Enter & Escape",
		description:
			"Step through the door. Solve the puzzles. Break free. Or remain trapped forever.",
	},
] as const;

const testimonials = [
	{
		id: "FL-1337",
		player: "Nick M.",
		message:
			"We had a great time at Escape Reality in Sarasota. Will definitely go there again.",
		signal: 89,
	},
	{
		id: "FL-4729",
		player: "Kaylee J.",
		message:
			"The staff here is very kind and makes it a great experience. The escape rooms are so fun to do with family and friends. Recommend this place for a fun get away!",
		signal: 94,
	},
	{
		id: "FL-8103",
		player: "Lori C.",
		message:
			"My first time in an escape room, had so much fun. We had a fantastic time. I would love to do it again.",
		signal: 87,
	},
	{
		id: "FL-6481",
		player: "Kristin C.",
		message:
			"We had a ball! Bring your friends, bring your family. The more the merrier! Highly recommend! The host, was super helpful and welcoming!",
		signal: 82,
	},
	{
		id: "FL-2956",
		player: "Kory L.",
		message:
			"Came a few times a few years ago and loved the how immersive the rooms were. Quality immersive rooms, attention to detail, clue creativity, friendly, and clean execution.",
		signal: 91,
	},
	{
		id: "FL-4820",
		player: "Becca P.",
		message:
			"We had a great time! Morgan was great and very helpful! Would definitely come back and I would recommend to anyone!",
		signal: 96,
	},
] as const;
---

<Layout>
	<link
		slot="head"
		rel="preload"
		href="/assets/fonts/orbitron-v35-latin-500.woff2"
		as="font"
		type="font/woff2"
		crossorigin="anonymous"
	/>
	<link
		slot="head"
		rel="preload"
		href="/assets/fonts/orbitron-v35-latin-900.woff2"
		as="font"
		type="font/woff2"
		crossorigin="anonymous"
	/>
	<link
		slot="head"
		rel="preload"
		href="/assets/fonts/roboto-mono-v31-latin-500.woff2"
		as="font"
		type="font/woff2"
		crossorigin="anonymous"
	/>
	<!-- Content -->
	<section id="hero" class="h-screen relative overflow-hidden">
		<img
			src="/assets/images/hero-backdrop.webp"
			width="1920"
			height="1080"
			class="absolute inset-0 size-full object-cover object-[40%_0%] opacity-10"
			style={{
				WebkitMaskImage:
					"radial-gradient(ellipse 100% 20% at 50% 100%, transparent 50%, #000 100%)",
				maskImage:
					"radial-gradient(ellipse 100% 20% at 50% 100%, transparent 50%, #000 100%)",
			}}
			alt="Standing bar inside a business"
			loading="eager"
		/>
		<div
			class="absolute inset-0 z-0 size-full animate-pulse-grid opacity-20"
			style={{
				backgroundImage: `
        linear-gradient(to right, rgba(0, 255, 255, 0.1) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0, 255, 255, 0.1) 1px, transparent 1px),
				linear-gradient(to right, rgba(255, 0, 170, 0.05) 3px, transparent 3px),
        linear-gradient(to bottom, rgba(255, 0, 170, 0.05) 3px, transparent 3px)
      `,
				backgroundSize: "30px 30px",
				WebkitMaskImage:
					"radial-gradient(ellipse 200% 30% at 50% 0%, transparent 50%, #000 100%), radial-gradient(ellipse 70% 40% at 50% 100%, transparent 50%, #000 100%)",
				maskImage:
					"radial-gradient(ellipse 200% 30% at 50% 0%, transparent 50%, #000 100%), radial-gradient(ellipse 70% 40% at 50% 100%, transparent 50%, #000 100%)",
				WebkitMaskComposite: "source-in",
				maskComposite: "intersect",
			}}
		>
		</div>
		<div
			class="font-heading w-full px-3 absolute top-[45%] left-1/2 -translate-1/2 flex flex-col gap-6"
		>
			<div>
				<h1
					class="text-6xl font-black text-center animate-glitch tracking-wider motion-reduce:animate-none motion-reduce:text-shadow-glitch md:text-7xl"
				>
					<span
						class="block animate-in slide-in-from-left-10 fade-in-0 duration-1000"
						>ESCAPE</span
					>
					<span
						class="block animate-in slide-in-from-right-10 fade-in-0 duration-1000"
						>REALITY</span
					>
				</h1>
			</div>
			<p
				class="text-lg font-medium font-body max-w-76 mx-auto mb-6 text-foreground/90 animate-in slide-in-from-bottom-50 fade-in-0 tracking-wide duration-800 md:max-w-none md:text-xl"
			>
				Sarasotaâ€™s Ultimate Escape Challenge
			</p>
			<div
				class="space-y-4 max-w-72 mx-auto w-full animate-in fade-in-0 duration-1000"
			>
				<div class="relative">
					<div
						class="absolute -z-1 pointer-events-none h-12 w-[calc(100%+6px)] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-primary/30 blur-lg rounded-md"
					>
					</div>
					<a
						href="#"
						class={buttonVariants({
							variant: "default",
							size: "lg",
							className: "w-full text-lg",
						})}>Book Now</a
					>
				</div>
				<a
					href="#"
					class={buttonVariants({
						variant: "outline",
						className: "w-full bg-background/80! text-xs hover:bg-background!",
					})}>View Rooms</a
				>
			</div>
		</div>
		<div
			class="text-sm opacity-50 text-muted-foreground/80 tracking-wide text-center leading-2.75 absolute bottom-8 left-1/2 -translate-x-1/2 w-full flex flex-col gap-0.5 md:flex-row md:gap-6 md:justify-center"
			aria-hidden="true"
		>
			<div>
				&gt; SYSTEM_STATUS: <span
					class="text-green-400 animate-[pulse_4s_cubic-bezier(0.4,0,0.6,1)_infinite]"
					>ACTIVE</span
				>
			</div>
			<br />
			<div>
				&gt; REALITY_CHECK: <span
					class="text-red-400 animate-[pulse_4s_cubic-bezier(0.4,0,0.6,1)_infinite]"
					>FAILED</span
				>
			</div>
		</div>
	</section>
	<div class="bg-linear-to-b from-background to-glitch-void">
		<section id="experiences" class="py-20 px-4 relative">
			<div class="container mx-auto relative z-10 max-w-7xl">
				<div class="text-center mb-16">
					<div class="inline-block mb-4">
						<span class="text-sm text-primary tracking-wider">
							&gt; DIMENSIONS_AVAILABLE: <span class="text-foreground">03</span>
						</span>
					</div>
					<h2
						class="text-3xl md:text-6xl font-black mb-4 text-shadow-glitch break-all animate-shimmer"
					>
						CHOOSE<span class="text-muted">_</span>YOUR<span class="text-muted"
							>_</span
						>REALITY
					</h2>
					<p class="text-muted-foreground max-w-2xl mx-auto">
						Each portal leads to a different dimension. Each dimension tests a
						different aspect of your mind. Choose wisely.
					</p>
				</div>
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					{
						experiences.map((room, index) => (
							<ExperienceCard index={index} {...room} />
						))
					}
				</div>
				<div
					x-data="{ isVisible: undefined }"
					x-intersect.threshold.70="isVisible = true"
					:class="isVisible && 'fade-in-0 animate-in visible'"
					class="mt-16 invisible text-center"
					style={{ "--tw-duration": "2s" }}
				>
					<span
						class="inline-block text-sm px-6 py-3 border border-border/80 rounded bg-background/80 text-muted-foreground/70"
					>
						&gt; MORE_DIMENSIONS_SOON
					</span>
				</div>
			</div>
		</section>
		<div
			class="overflow-hidden h-16 max-w-[1920px] mx-auto opacity-10 w-full flex"
		>
			{
				Array.from({ length: 33 }).map((_, i) => (
					<div
						class="text-primary text-xs animate-pulse"
						style={{
							animationDelay: `${i * 0.1}s`,
							animationDuration: "1s",
						}}
					>
						01010011
						<br />
						11000101
						<br />
						10100011
						<br />
						01110110
						<br />
						01010011
						<br />
						11000101
						<br />
						10100011
						<br />
						01110110
					</div>
				))
			}
		</div>
		<section id="how-it-works" class="py-20 px-4 relative">
			<div class="container mx-auto relative z-10">
				<div class="text-center mb-16">
					<div class="inline-block mb-4">
						<span class="text-sm text-primary tracking-wider">
							&gt; ESCAPE_PROTOCOL: <span class="text-foreground"
								>INITIALIZED</span
							>
						</span>
					</div>
					<h2
						class="text-4xl md:text-6xl font-black mb-4 text-shadow-glitch animate-shimmer"
					>
						THE<span class="text-muted">_</span>INTERFACE
					</h2>
				</div>
				<div
					class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-7xl mx-auto"
				>
					{
						processSteps.map((step, index) => (
							<ProcessCard
								arrLength={processSteps.length}
								index={index}
								{...step}
							/>
						))
					}
				</div>
				<div
					x-data="{ isVisible: undefined }"
					x-intersect.threshold.70="isVisible = true"
					:class="isVisible && 'fade-in-0 animate-in visible'"
					class="mt-16 max-w-156 mx-auto invisible"
					style={{ "--tw-duration": "2.25s" }}
				>
					<div class="border border-primary/20 rounded p-6 text-xs space-y-2">
						<div class="text-primary">&gt; SYSTEM_MESSAGE:</div>
						<p class="text-muted-foreground leading-relaxed">
							Teams that fail to escape within the allotted time will remain in
							their chosen dimension indefinitely.
						</p>
						<span class="text-destructive">Proceed at your own risk.</span>
					</div>
				</div>
			</div>
		</section>
		<section class="pt-20 pb-12 px-4 md:pb-20">
			<div class="container mx-auto relative z-10">
				<div class="text-center mb-16">
					<div class="inline-block mb-4">
						<span class="text-sm text-primary tracking-wider">
							&gt; INTERCEPTED_TRANSMISSIONS: <span class="text-foreground"
								>05</span
							>
						</span>
					</div>
					<h2
						class="text-4xl md:text-6xl font-black mb-4 text-shadow-glitch animate-shimmer"
					>
						SURVIVOR<span class="text-muted">_</span>SIGNALS
					</h2>
					<p class="text-muted-foreground">
						Fragments intercepted from those who've crossed the threshold.
					</p>
				</div>
				<div
					x-data="{ isVisible: undefined }"
					x-intersect.threshold.30="isVisible = true"
					:data-visible="isVisible"
					class="max-w-6xl mx-auto relative flex flex-col items-center gap-10 md:min-h-[600px] mb-16"
				>
					{
						testimonials.map((testimonial, index) => (
							<TestimonialCard index={index} {...testimonial} />
						))
					}
				</div>
			</div>
		</section>
		<section
			class="relative py-60 px-4 overflow-hidden border-t border-border/40 md:mt-30 md:pt-40"
		>
			<div class="absolute inset-0 flex items-center justify-center">
				<div
					class="absolute size-[800px] rounded-full border-2 border-primary/20 animate-vortex"
				>
				</div>
				<div
					class="absolute size-[600px] rounded-full border-2 border-accent/20 animate-vortex"
					style={{ animationDuration: "15s", animationDirection: "reverse" }}
				>
				</div>
				<div
					class="absolute size-[400px] rounded-full border-2 border-secondary/20 animate-vortex"
					style={{ animationDuration: "10s" }}
				>
				</div>
			</div>
			<div class="container mx-auto relative z-10 text-center">
				<div class="max-w-4xl mx-auto">
					<div class="mb-6">
						<span
							class="text-sm text-primary tracking-wider inline-block px-4 py-2 border border-primary/30 rounded bg-primary/5"
						>
							&gt; FINAL_GATEWAY_PROTOCOL: <span
								class="text-foreground animate-pulse">ACTIVE</span
							>
						</span>
					</div>
					<h2
						class="text-5xl md:text-6xl font-black mb-6 animate-glitch leading-tight motion-reduce:animate-none motion-reduce:text-shadow-glitch"
					>
						REALITY<span class="text-muted">_</span>IS
						<br />
						OVERRATED
					</h2>
					<p
						class="text-base md:text-xl text-muted-foreground mb-12 max-w-2xl mx-auto leading-relaxed"
					>
						The simulation is cracking. The portals are open. Your escape awaits
						beyond the threshold. Will you cross over?
					</p>
					<div
						class="flex flex-col sm:flex-row gap-6 justify-center items-center mb-12"
					>
						<a
							href="#book"
							class={buttonVariants({
								size: "lg",
								className:
									"bg-linear-to-r from-primary/20 via-secondary/10 to-primary/40 px-12 py-6 text-base! shadow-lg shadow-primary/20 transition-all will-change-transform hover:scale-101 hover:shadow-primary/60",
							})}
						>
							BOOK_NOW
						</a>
					</div>
					<div
						x-data="{
							visible: undefined,
							escapes: 0,
							animate() {
								let e = 0;
								const eTarget = 2600;
								const step = () => {
									if (e < eTarget) e += 20;
									this.escapes = e;
									if (e < eTarget) requestAnimationFrame(step)
								}
								step()
							}
						}"
						:data-visible="visible"
						x-intersect="visible = true; animate();"
						class="grid grid-cols-3 max-w-xl mx-auto text-primary group"
					>
						<div class="text-center">
							<div
								class="text-3xl md:text-4xl mb-2 w-21 mx-auto origin-bottom animate-[countY_0.8s_ease-in-out]"
								x-text="escapes"
							>
								0
							</div>
							<div class="text-sm text-muted-foreground">ESCAPES</div>
						</div>
						<div class="text-center border-x border-primary/20 px-3">
							<div
								class="text-3xl md:text-4xl mb-2 w-21 mx-auto invisible fade-in-0 duration-1000 group-data-visible:animate-in group-data-visible:visible"
							>
								03
							</div>
							<div class="text-sm text-muted-foreground">DIMENSIONS</div>
						</div>
						<div class="flex flex-col items-center justify-between">
							<InfinityIcon
								className="size-10 mb-1 spin-in fade-in-0 duration-1000 invisible group-data-visible:visible group-data-visible:animate-in"
							/>
							<div class="text-sm text-muted-foreground">CHANCES</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>
</Layout>
